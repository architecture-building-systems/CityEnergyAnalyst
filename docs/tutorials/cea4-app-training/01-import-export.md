# Import & Export

This category contains features for exchanging data between CEA and external applications, as well as generating summary reports.

---

## Export to Rhino/Grasshopper

### Overview
Exports CEA files into Rhino/Grasshopper-ready format, allowing you to visualise and further process CEA geometry and results in Rhinoceros 3D and Grasshopper.

### When to Use
- Visualising building geometry in 3D
- Creating presentation-quality renders
- Further geometric analysis in Rhino/Grasshopper
- Integrating CEA workflows with architectural design tools
- Using cea4gh (CEA for Grasshopper) plugin

### Required Inputs
- **Zone geometry**: Building footprints with geometry data

### Key Parameters
- **Include zone**: Export zone building geometries
- **Include site**: Export site boundary polygon
- **Include surroundings**: Export surrounding building geometries
- **Include streets**: Export street network
- **Include trees**: Export tree geometries
- **Include district heating network**: Export DH network edges and nodes
- **Include district cooling network**: Export DC network edges and nodes

### How to Use

1. Open the CEA-4 App and navigate to **Import & Export**
2. Select **Export to Rhino/Grasshopper**
3. Configure which elements to export:
   - Select zone buildings (typically always enabled)
   - Optionally include site, surroundings, streets, trees
   - Optionally include thermal networks if they exist
4. Click **Run**
5. Find exported files at:
   ```
   {CEA Project}/{Current Scenario}/export/rhino/from_cea/
   ```

### Output Files
The feature exports CSV files containing geometric coordinates:
- `zone.csv` - Main zone building geometries
- `site.csv` - Site boundary (if exists)
- `surroundings.csv` - Surrounding buildings (if exists)
- `streets.csv` - Street network (if exists)
- `trees.csv` - Tree geometries (if exists)
- `DH_edges.csv` / `DH_nodes.csv` - District heating network (if exists)
- `DC_edges.csv` / `DC_nodes.csv` - District cooling network (if exists)

All coordinates are standardised to a projected coordinate system for use in Rhino/Grasshopper.

### Next Steps
After exporting:
1. Download **cea4gh** (CEA for Grasshopper) from [https://www.cityenergyanalyst.com/cea4gh](https://www.cityenergyanalyst.com/cea4gh)
2. Use the cea4gh Grasshopper components to import the exported CSV files into Rhino
3. Visualise and analyse your urban energy model in 3D

### Tips
- Export all available geometry layers for complete visualisation
- The coordinate system is automatically reprojected for optimal use in Rhino
- Use this feature to create presentation materials and 3D visualisations

### Troubleshooting
**Issue**: Export folder is empty
- **Solution**: Ensure you have valid zone geometry in your scenario

**Issue**: Missing network files
- **Solution**: Run Thermal Network Part 1 (layout) before exporting networks

---

## Import from Rhino/Grasshopper

### Overview
Imports Rhino/Grasshopper-generated files back into CEA, allowing you to use external design tools to create or modify building geometry before CEA analysis.

### When to Use
- Creating new building geometries in Rhino/Grasshopper
- Modifying existing geometries with architectural design tools
- Preparing complex urban morphologies
- Integrating architectural design workflows with CEA analysis

### Prerequisites
- **cea4gh** installed and configured
- Scenario created using cea4gh in Grasshopper
- Current CEA scenario matches the cea4gh-generated scenario

### How to Use

1. **In Rhino/Grasshopper**:
   - Download and install cea4gh from [https://www.cityenergyanalyst.com/cea4gh](https://www.cityenergyanalyst.com/cea4gh)
   - Use cea4gh components to create CEA-compatible geometry
   - Export using cea4gh to create a CEA scenario structure

2. **In CEA-4 App**:
   - Ensure the current scenario is the one generated by cea4gh
   - Navigate to **Import & Export**
   - Select **Import from Rhino/Grasshopper**
   - Click **Run**

### What Gets Imported
The feature imports:
- Building footprint geometries
- Building heights
- Building properties (if assigned in Grasshopper)
- Site boundaries
- Surroundings (context buildings)

### Next Steps
After importing:
1. Verify imported geometry using the 3D viewer in CEA-4 App
2. Use **Archetypes Mapper** to assign building properties if not already set
3. Continue with standard CEA workflow (Solar Radiation → Demand → Analysis)

### Tips
- Always use cea4gh to ensure CEA-compatible geometry
- Verify that building footprints are valid polygons (no self-intersections)
- Ensure buildings have positive heights
- Name buildings systematically (e.g., B001, B002, etc.)

### Troubleshooting
**Issue**: Import fails with geometry errors
- **Solution**: Verify geometry validity in Grasshopper using cea4gh validation components

**Issue**: "Scenario mismatch" error
- **Solution**: Ensure the active CEA scenario matches the one created by cea4gh

**Issue**: Missing building properties
- **Solution**: Assign properties in Grasshopper, or use Archetypes Mapper after import

---

## Export Results to CSV (Summary & Analytics)

### Overview
Generates CSV files containing aggregated CEA results for custom analysis, reporting, and data exchange. This feature provides flexible data export by building, time period, and metric.

### When to Use
- Creating custom reports and dashboards
- Performing statistical analysis in Excel, Python, or R
- Comparing scenarios side-by-side
- Generating data for publications and presentations
- Integrating CEA results with other software tools

### Required Inputs
- **Zone geometry**: Building footprints
- **Analysis results**: At least one completed CEA analysis (e.g., demand, solar, emissions)

### Key Parameters
- **Building filter**: Select specific buildings or all buildings
- **Time aggregation**: Hourly, daily, monthly, or yearly summaries
- **Metrics**: Choose which results to export (demand, emissions, costs, solar, etc.)

### How to Use

1. Complete at least one CEA analysis (e.g., Energy Demand, Emissions, PV assessment)
2. Navigate to **Import & Export**
3. Select **Export Results to CSV (Summary & Analytics)**
4. Configure export options:
   - Select buildings to include (or use "All buildings")
   - Choose time aggregation level (hourly/daily/monthly/yearly)
   - Select metrics to export
5. Click **Run**
6. Find exported CSV files in:
   ```
   {CEA Project}/{Current Scenario}/outputs/data/exports/
   ```

### Output Structure
The feature generates structured CSV files with:
- Building-level aggregations
- Time-series data (if selected)
- Summary statistics
- Customised metric columns based on selection

Example output columns:
- `Name` - Building identifier
- `GFA_m2` - Gross floor area
- `Qhs_MWhyr` - Annual space heating demand
- `Qcs_MWhyr` - Annual space cooling demand
- `E_MWhyr` - Annual electricity demand
- Additional columns based on available results

### Use Cases

**Scenario Comparison**
1. Export results for Scenario A
2. Export results for Scenario B
3. Compare CSV files in Excel or Python

**Custom Reporting**
1. Export all metrics for selected buildings
2. Import into Excel/PowerBI
3. Create custom charts and pivot tables

**Statistical Analysis**
1. Export hourly time-series data
2. Analyse in Python/R
3. Perform statistical tests and regressions

### Tips
- Export yearly summaries for high-level comparisons
- Export hourly data for detailed temporal analysis
- Use building filters to focus on specific building types
- Combine with Excel pivot tables for flexible reporting

### Troubleshooting
**Issue**: Empty export files
- **Solution**: Ensure you have completed at least one CEA analysis before exporting

**Issue**: Missing metrics in export
- **Solution**: Some metrics only appear after specific analyses (e.g., PV data requires PV analysis)

**Issue**: Too large file for hourly data
- **Solution**: Use daily or monthly aggregation, or filter to fewer buildings

---

## Common Workflows

### Workflow 1: CEA to Rhino Visualisation
1. Complete CEA analysis (demand, solar, emissions)
2. **Export to Rhino/Grasshopper** with all layers
3. Open exported files in Rhino using cea4gh
4. Create 3D visualisations and renderings

### Workflow 2: Rhino to CEA Analysis
1. Design building geometry in Rhino/Grasshopper
2. Use cea4gh to export CEA-compatible scenario
3. **Import from Rhino/Grasshopper** in CEA-4 App
4. Run standard CEA analysis workflow

### Workflow 3: Results Export for Custom Analysis
1. Complete CEA analyses
2. **Export Results to CSV** with desired metrics
3. Perform custom analysis in Excel, Python, or R
4. Create custom reports and visualisations

---

## Related Features
- **[Data Management](08-data-management.md)** - Prepare input data before analysis
- **[Visualisation](10-visualisation.md)** - Built-in plotting features
- **[Utilities](09-utilities.md)** - File format conversion tools

---

[← Back to Index](index.md) | [Next: Solar Radiation Analysis →](02-solar-radiation.md)
